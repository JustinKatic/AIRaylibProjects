#pragma once
#include "GameObject.h"
#include <vector>
class Graph2D;
class Graph2DEditor;
class Player;
class RedGhost;
class BlueGhost;


enum MAP_ITEMS
{
	EMPTY = 0,
	WALL = 1,
	FOOD = 2,
	POWERUP = 3,
	START = 4,
	BLUEGHOST = 5,
	REDGHOST = 6,
	SAFEZONE = 7,
	SAFEPATH = 8,
	SAFEENTRY = 9,
	SAFEENTRYDOOR = 10
};


class Application
{
public:

	struct Rect
	{
		Vector2 pos;
		Vector2 size;
	};

	Application();
	~Application();

	void Run();

	void Update(float deltaTime);
	void UpdateInfluence(float deltaTime);

	void Draw();
	void DrawInfluenceMap();

	void Load();
	void Unload();

	Player* GetPlayer();
	Graph2D* GetGraph();

	int m_tileWidth;
	int m_tileHeight;

	bool gameOver = false;
	int m_score = 0;
	std::vector<Rect> noGo;

private:
	Player* m_player = nullptr;
	RedGhost* m_redGhost = nullptr;
	BlueGhost* m_blueGhost = nullptr;


	int m_windowWidth;
	int m_windowHeight;

	//===============================================================================================================
	Graph2D* m_graph = nullptr;
	Graph2DEditor* m_graphEditor = nullptr;
	//===============================================================================================================

	Image backGroundImg;
	Texture2D backGroundTex;

	Image wallImg;
	Texture2D wallTex;

	Image sideWallImg;
	Texture2D sideWallTex;

	Image topBottomWallImg;
	Texture2D topBottomWallTex;

	Image safeBoxImg;
	Texture2D safeBoxTex;

	Image VImg;
	Texture2D VTex;




	int m_screenWidth;
	int m_screenHeight;



	static const int MAP_ROWS = 30;
	static const int MAP_COLS = 56;


	std::vector<std::vector<float>> m_influence;
	

	int m_map[MAP_ROWS][MAP_COLS] = {
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
		{1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,0,1},
		{1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1},
		{1,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,5,8,6,10,9,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,8,8,8,10,9,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,1},
		{1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1},
		{1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1},
		{1,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1,1,1,1,1,1,0,2,2,0,1},
		{1,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,1},
		{1,0,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1},
		{1,0,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1},
		{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	};

};